<div class="page-header">
    <div class="pull-right">
        <button b:onclick="saveTicket()" type="button" class="btn btn-primary btn-lg">Save</button>
    </div>
    <h1>Ticket</h1>
 </div>


<form class="form-horizontal" role="form">

    <div class="form-group">
        <b:textfield b:bind="ticket.title" id="title" lcols="2" fcols="10" text="Title" label="Title" focus="1"></b:textfield>
    </div>

    <div class="form-group">
        <b:memofield b:bind="ticket.description" id="title" lcols="2" fcols="10" text="Description" label="Description"></b:memofield>
    </div>

    <div class="form-group">
        <b:staticfield b:bind="ticket.created" id="created" lcols="2" fcols="4" label="Created"></b:staticfield>
        <b:staticfield b:bind="ticket.creator.firstName + ' ' + ticket.creator.lastName" id="lastName" lcols="2" fcols="4" label="Last Name"></b:staticfield>
    </div>

    <div class="form-group">
        <b:objectselectfield b:bind="ticket.project" id="project" lcols="2" fcols="4" label="Project" values="getProjects()" text="name" empty="none" onchange="if(!ticket.project){ticket.release=null}"></b:objectselectfield>
        <b:if test="ticket.project">
            <b:objectselectfield b:bind="ticket.release" id="release" lcols="2" fcols="4" label="Release" values="ticket.project.releases" text="name" empty="none"></b:objectselectfield>
        </b:if>
    </div>

</form>

<b:if test="false">
<form class="form-horizontal" role="form">

    <div class="form-group" b:show="false">
        <b:memofield b:bind="comment" id="comment" lcols="2" fcols="10" text="Comment" label="Comment"></b:memofield>
        <button b:onclick="ticket.addComment();comment=''" type="button" class="btn btn-primary btn-lg">Save</button>
        <button b:showif="!comment" b:onclick="saveTicket()" type="button" class="btn btn-primary btn-lg">Approve</button>
    </div>


</form>
</b:if>

<div class="container">
    <table class="table" b:showif="ticket.ticketItems > 0">
        <thead>
        <tr>
            <th>Created</th>
            <th>By</th>
            <th>Comment</th>
        </tr>
        </thead>
        <tbody>
        <tr b:iterateon="ticketItem" b:iteratewith="row">
            <td b:bind="row.created"></td>
            <td b:bind="row.creator.getFullName()"></td>
            <td>
                <span b:showif="row instanceof ticketItemComment" b:bind="row.text"></span>
                <span b:showif="row instanceof ticketItemApproval"><strong>Approved</strong></span>
                </span>
            </td>

        </tr>
        </tbody>
    </table>
</div>

