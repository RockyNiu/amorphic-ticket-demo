<div class="page-header">
    <div class="pull-right">
        <button b:onclick="saveTicket()" type="button" class="btn btn-primary btn-lg">Save</button>
    </div>
    <h1>Ticket</h1>
 </div>


<form class="form-horizontal" role="form">

    <div class="form-group">
        <b:textfield b:bind="ticket.title" id="title" lcols="2" fcols="10" text="Title" label="Title" focus="1"></b:textfield>
    </div>

    <div class="form-group">
        <b:memofield b:bind="ticket.description" id="title" lcols="2" fcols="10" text="Description" label="Description"></b:memofield>
    </div>

    <div class="form-group">
        <b:staticfield b:bind="ticket.created" id="created" lcols="2" fcols="4" label="Created"></b:staticfield>
        <b:staticfield b:bind="ticket.creator.firstName + ' ' + ticket.creator.lastName" id="lastName" lcols="2" fcols="4" label="Last Name"></b:staticfield>
    </div>

    <div class="form-group">
        <b:objectselectfield b:bind="ticket.project" id="project" lcols="2" fcols="4" label="Project" values="getProjects()" text="name" empty="none" onchange="if(!ticket.project){ticket.release=null}"></b:objectselectfield>
        <b:if test="ticket.project">
            <b:objectselectfield b:bind="ticket.release" id="release" lcols="2" fcols="4" label="Release" values="ticket.project.releases" text="name" empty="none"></b:objectselectfield>
        </b:if>
    </div>

</form>

<b:if test="false">
<form class="form-horizontal" role="form">

    <div class="form-group" b:show="false">
        <b:memofield b:bind="comment" id="comment" lcols="2" fcols="10" text="Comment" label="Comment"></b:memofield>
        <button b:onclick="ticket.addComment();comment=''" type="button" class="btn btn-primary btn-lg">Save</button>
        <button b:showif="!comment" b:onclick="saveTicket()" type="button" class="btn btn-primary btn-lg">Approve</button>
    </div>


</form>
</b:if>

<div class="container">
    <table class="table" b:showif="ticket.ticketItems > 0">
        <thead>
        <tr>
            <th>Created</th>
            <th>By</th>
            <th>Comment</th>
        </tr>
        </thead>
        <tbody>
        <tr b:iterateon="ticketItem" b:iteratewith="row">
            <td b:bind="row.created"></td>
            <td b:bind="row.creator.getFullName()"></td>
            <td>
                <span b:showif="row instanceof ticketItemComment" b:bind="row.text"></span>
                <span b:showif="row instanceof ticketItemApproval"><strong>Approved</strong></span>
                </span>
            </td>

        </tr>
        </tbody>
    </table>
</div>

{"_id":"1e9fdc1d5ee3578fd7d5faa16d55b33b","_rev":"2-659493a90cf0c4cefeb66f89803d3f34","status":"fail","payload":{"ref":"refs/heads/master","after":"dd3ea300c48
62dc68e858b47c71141b43e0f423","before":"85f85188ad46687adcc88e30c7bd6f703142cf38","created":false,"deleted":false,"forced":false,"compare":"https://github.com/
elsamman/semotus/compare/85f85188ad46...dd3ea300c486","commits":[{"id":"e2f076d5d6d02bd44f4a01a2fa8b2dc055ca4f58","distinct":true,"message":"Broke out authenti
ation (first pass)","timestamp":"2014-03-12T22:05:08-04:00","url":"https://github.com/selsamman/semotus/commit/e2f076d5d6d02bd44f4a01a2fa8b2dc055ca4f58","autho
":{"name":"Sam Elsamman","email":"sams@elsamman.com","username":"selsamman"},"committer":{"name":"Sam Elsamman","email":"sams@elsamman.com","username":"selsamm
n"},"added":[],"removed":[],"modified":["README.md"]},{"id":"01aab9ac8eeea4d3b659a98554791c6bf296af96","distinct":true,"message":"First commit of cascade fetch
s","timestamp":"2014-03-12T22:46:35-04:00","url":"https://github.com/selsamman/semotus/commit/01aab9ac8eeea4d3b659a98554791c6bf296af96","author":{"name":"Sam E
samman","email":"sams@elsamman.com","username":"selsamman"},"committer":{"name":"Sam Elsamman","email":"sams@elsamman.com","username":"selsamman"},"added":[],"
emoved":[],"modified":["apps/ticket/public/js/project.js","apps/ticket/public/js/ticket.js","apps/ticket/public/ticket.html","node_modules/semotus/persistObjec
Template.js"]},{"id":"dd3ea300c48662dc68e858b47c71141b43e0f423","distinct":true,"message":"First commit of cascading fetches","timestamp":"2014-03-12T22:52:19-
4:00","url":"https://github.com/selsamman/semotus/commit/dd3ea300c48662dc68e858b47c71141b43e0f423","author":{"name":"Sam Elsamman","email":"sams@elsamman.com",
username":"selsamman"},"committer":{"name":"Sam Elsamman","email":"sams@elsamman.com","username":"selsamman"},"added":[],"removed":[],"modified":["README.md","
pps/ticket/public/ticket.html"]}],"head_commit":{"id":"dd3ea300c48662dc68e858b47c71141b43e0f423","distinct":true,"message":"First commit of cascading fetches",
timestamp":"2014-03-12T22:52:19-04:00","url":"https://github.com/selsamman/semotus/commit/dd3ea300c48662dc68e858b47c71141b43e0f423","author":{"name":"Sam Elsam
an","email":"sams@elsamman.com","username":"selsamman"},"committer":{"name":"Sam Elsamman","email":"sams@elsamman.com","username":"selsamman"},"added":[],"remo
ed":[],"modified":["README.md","apps/ticket/public/ticket.html"]},"repository":{"id":14987096,"name":"semotus","url":"https://github.com/selsamman/semotus","de
cription":"A framework for building object-oriented web applications using nodejs and MongoDB","watchers":0,"stargazers":0,"forks":0,"fork":false,"size":2248,"
wner":{"name":"selsamman","email":"sams@elsamman.com"},"private":false,"open_issues":0,"has_issues":true,"has_downloads":true,"has_wiki":true,"language":"JavaS
ript","created_at":1386345926,"pushed_at":1394679142,"master_branch":"master"},"pusher":{"name":"none"},"ref_name":"master"},"uuid":"b23f0t1394710299631","non_
atal_errors":{"travis":{"message":"Unspecified error","stack":"Error: Failed to fetch `.travis.yml`. Is this a private repo?\n    at Request._callback (/opt/ru
/snapshot/package/lib/github.js:160:23)\n    at Request.self.callback (/opt/run/snapshot/package/node_modules/request/request.js:129:22)\n    at Request.EventE
itter.emit (events.js:98:17)\n    at Request.<anonymous> (/opt/run/snapshot/package/node_modules/request/request.js:873:14)\n    at Request.EventEmitter.emit (
    vents.js:117:20)\n    at IncomingMessage.<anonymous> (/opt/run/snapshot/package/node_modules/request/request.js:824:12)\n    at IncomingMessage.EventEmitter.em
        t (events.js:117:20)\n    at _stream_readable.js:920:16\n    at process._tickCallback (node.js:415:13)","name":"Error","error":"deploy:travis:parse_payload","d
        scription":"Failed to fetch `.travis.yml`. Is this a private repo?","stacktrace":["Error: Failed to fetch `.travis.yml`. Is this a private repo?","    at Reque
        t._callback (/opt/run/snapshot/package/lib/github.js:160:23)","    at Request.self.callback (/opt/run/snapshot/package/node_modules/request/request.js:129:22)"
        "    at Request.EventEmitter.emit (events.js:98:17)","    at Request.<anonymous> (/opt/run/snapshot/package/node_modules/request/request.js:873:14)","    at Re
            uest.EventEmitter.emit (events.js:117:20)","    at IncomingMessage.<anonymous> (/opt/run/snapshot/package/node_modules/request/request.js:824:12)","    at Inco
                ingMessage.EventEmitter.emit (events.js:117:20)","    at _stream_readable.js:920:16","    at process._tickCallback (node.js:415:13)"]},"nodejitsu":{"message":"
                nspecified error","stack":"Error: Request failed\n    at Request._callback (/opt/run/snapshot/package/lib/nodejitsu.js:72:31)\n    at Request.self.callback (/o
                t/run/snapshot/package/node_modules/request/request.js:129:22)\n    at Request.EventEmitter.emit (events.js:98:17)\n    at Request.<anonymous> (/opt/run/snapsh
                    t/package/node_modules/request/request.js:873:14)\n    at Request.EventEmitter.emit (events.js:117:20)\n    at IncomingMessage.<anonymous> (/opt/run/snapshot/p
                        ckage/node_modules/request/request.js:824:12)\n    at IncomingMessage.EventEmitter.emit (events.js:117:20)\n    at _stream_readable.js:920:16\n    at process._
                        ickCallback (node.js:415:13)","name":"Error","reason":"Error Creating Nodejitsu App!","error":"deploy:nodejitsu:cant_create_app","nodejitsu":{"err":{"message":
                        Application already exists"},"status_code":409},"description":"Request failed","stacktrace":["Error: Request failed","    at Request._callback (/opt/run/snapsh
                        t/package/lib/nodejitsu.js:72:31)","    at Request.self.callback (/opt/run/snapshot/package/node_modules/request/request.js:129:22)","    at Request.EventEmitt
                        r.emit (events.js:98:17)","    at Request.<anonymous> (/opt/run/snapshot/package/node_modules/request/request.js:873:14)","    at Request.EventEmitter.emit (ev
                            nts.js:117:20)","    at IncomingMessage.<anonymous> (/opt/run/snapshot/package/node_modules/request/request.js:824:12)","    at IncomingMessage.EventEmitter.em
                                t (events.js:117:20)","    at _stream_readable.js:920:16","    at process._tickCallback (node.js:415:13)"]}},"created_at":"Thu Mar 13 2014 11:31:39 GMT+0000 (U
                                C)","epoch":{"created_at":1394710299874,"rendered_at":1394710328682},"github":{"branch":"master","owner":"selsamman","repo":"semotus","slug":"selsamman/semotus
                                ,"commit":"dd3ea300c48662dc68e858b47c71141b43e0f423","provider":"github"},"parsedPayload":{"branch":"master","owner":"selsamman","repo":"semotus","slug":"selsa
                                man/semotus","commit":"dd3ea300c48662dc68e858b47c71141b43e0f423","provider":"github"},"couch":{"ok":true,"id":"1e9fdc1d5ee3578fd7d5faa16d55b33b","rev":"1-6d93b
                                7e70607cff12b9d596885fa78e"},"package.json":{"name":"semotus","subdomain":"semotus","version":"0.0.3","engines":{"node":"0.10.x"},"scripts":{"start":"app.js"}}
                                "app_name":"semotus","rendered_at":"Thu Mar 13 2014 11:32:08 GMT+0000 (UTC)","status_code":200,"err":{"message":"Unspecified error","stack":"SyntaxError: Unexp
                                cted token p\n    at Object.parse (native)\n    at Object.nodejitsu.deploy (/opt/run/snapshot/package/lib/nodejitsu.js:137:17)\n    at Request.<anonymous> (/op
                                    /run/snapshot/package/models/deploy.js:595:29)\n    at Request.EventEmitter.emit (events.js:117:20)\n    at IncomingMessage.<anonymous> (/opt/run/snapshot/pack
                                        ge/node_modules/request/request.js:824:12)\n    at IncomingMessage.EventEmitter.emit (events.js:117:20)\n    at _stream_readable.js:920:16\n    at process._tic
                                        Callback (node.js:415:13)","name":"Error","versions":{"env":"production","node":{"http_parser":"1.0","node":"0.10.21","v8":"3.14.5.9","ares":"1.9.0-DEV","uv":"
                                        .10.18","zlib":"1.2.3","modules":"11","openssl":"1.0.1e"},"api":"1.8.2"},"uuid":"b23f0t1394710299631","reason":"Error starting app in nodejitsu","error":"deplo
                                        :nodejitsu:start_app","status_code":200,"description":"Unspecified error","stacktrace":["SyntaxError: Unexpected token p","    at Object.parse (native)","    a
                                        Object.nodejitsu.deploy (/opt/run/snapshot/package/lib/nodejitsu.js:137:17)","    at Request.<anonymous> (/opt/run/snapshot/package/models/deploy.js:595:29)",
                                            at Request.EventEmitter.emit (events.js:117:20)","    at IncomingMessage.<anonymous> (/opt/run/snapshot/package/node_modules/request/request.js:824:12)","
                                                at IncomingMessage.EventEmitter.emit (events.js:117:20)","    at _stream_readable.js:920:16","    at process._tickCallback (node.js:415:13)"]},"etc":{"user":
                                                elsamman","http_headers":{"host":"webhooks.nodejitsu.com","accept":"*/*","user-agent":"GitHub Hookshot 9cef5dd","content-type":"application/x-www-form-urlencod
                                                d","content-length":"4229","x-forwarded-for":"192.30.252.41","x-forwarded-port":"443","x-forwarded-proto":"https","connection":"keep-alive"},"uuid":"b23f0t1394
                                                10299631","email":"sams@elsamman.com"},"email":{"success":true,"errors":true}}